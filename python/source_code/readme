只保留核心代码和逻辑,部分代码会用等价形式替换(不保证正确,仅供学习)
